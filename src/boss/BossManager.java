package boss;

import boss.boss_list_ViThu.BOTVIP.GokuBlack;
import boss.boss_list_ViThu.NYCTHAO;
import boss.boss_list_ViThu.vithu1;
import boss.boss_list_ViThu.vithu2;
import boss.boss_list_ViThu.vithu3;
import boss.boss_list_ViThu.vithu4;
import boss.boss_list_ViThu.vithu5;
import boss.boss_list_ViThu.vithu6;
import boss.boss_list_ViThu.vithu7;
import boss.boss_list_ViThu.vithu8;
import boss.boss_list_ViThu.vithu9;
import boss.boss_list_doremon.BOSSNGOCRONG;
import boss.boss_list_doremon.chanen;
import boss.boss_list_doremon.doremon;
import boss.boss_list_doremon.nobita;
import boss.boss_list_doremon.xeko;
import boss.boss_list_doremon.xuka;
import boss.boss_list_doremon.vlxx;
import boss.boss_list_tainguyen.BLACKGOKU;
import boss.boss_list_tainguyen.BLACKGOKUROSE;

import boss.boss_list_tainguyen.FU;
import boss.boss_list_tainguyen.KELA;
import boss.boss_list_tainguyen.NGUSAC;
import boss.boss_list_tainguyen.NYCLOAN;
import boss.boss_list_tainguyen.OBITOVIP;
import boss.boss_list_tainguyen.XETANG390;
import boss.boss_list_tainguyen.ZAMASU;
import boss.boss_list_tainguyen.bosskeyvang;
import boss.boss_list_tainguyen.pan;
import boss.boss_list_tainguyen.bossskhts;
import boss.boss_list_tainguyen.LUFFI;
import boss.boss_list_tainguyen.SANJI;
import boss.boss_list_tainguyen.BOSSADMIN;
import boss.boss_list_tainguyen.sex;

import boss.boss_manifest.Black.BlackGoku;
import boss.boss_manifest.Broly.SuperBrolyNew;
import boss.boss_manifest.Nappa.Rambo;
import boss.boss_manifest.Nhan_Gioi.OBITO_LUC_DAO1;
import boss.boss_manifest.Nhan_Gioi.CuuVi;
import boss.boss_manifest.Nhan_Gioi.Obito;
import boss.boss_manifest.Nhan_Gioi.ObitoLucDao;
import boss.boss_manifest.Nappa.MapDauDinh;
import boss.boss_manifest.Nappa.Kuku;
import boss.boss_manifest.Android.Android19;
import boss.boss_manifest.Android.Pic;
import boss.boss_manifest.Android.Android14;
import boss.boss_manifest.Android.Poc;
import boss.boss_manifest.Android.Android13;
import boss.boss_manifest.Android.KingKong;
import boss.boss_manifest.Android.DrKore;
import boss.boss_manifest.Android.Android15;
import boss.boss_manifest.GoldenFrieza.DeathBeam1;
import boss.boss_manifest.GoldenFrieza.DeathBeam2;
import boss.boss_manifest.GoldenFrieza.DeathBeam3;
import boss.boss_manifest.GoldenFrieza.DeathBeam4;
import boss.boss_manifest.GoldenFrieza.DeathBeam5;
import boss.boss_manifest.GoldenFrieza.GoldenFrieza;
import boss.boss_manifest.Cooler.Cooler;
import boss.boss_manifest.Cell.SieuBoHung;
import boss.boss_manifest.Cell.XenBoHung;
import boss.boss_manifest.Broly.Broly;
import boss.boss_manifest.ChristmasEvent.OngGiaNoel;
import boss.boss_manifest.TaoPaiPai.TaoPaiPai;
import boss.boss_manifest.Frieza.Fide;
import boss.boss_manifest.HungVuongEvent.SonTinh;
import boss.boss_manifest.HungVuongEvent.ThuyTinh;
import boss.boss_manifest.HalloweenEvent.BiMa;
import boss.boss_manifest.HalloweenEvent.Doi;
import boss.boss_manifest.HalloweenEvent.MaTroi;
import boss.boss_manifest.TrungThuEvent.KhiDot;
import boss.boss_manifest.TrungThuEvent.NguyetThan;
import boss.boss_manifest.TrungThuEvent.NhatThan;
import boss.boss_manifest.MajinBuu12H.Mabu;
import boss.boss_manifest.MajinBuu12H.BuiBui;
import boss.boss_manifest.MajinBuu12H.BuiBui2;
import boss.boss_manifest.MajinBuu12H.Cadic;
import boss.boss_manifest.MajinBuu12H.Drabura;
import boss.boss_manifest.MajinBuu12H.Drabura2;
import boss.boss_manifest.MajinBuu12H.Drabura3;
import boss.boss_manifest.MajinBuu12H.Goku;
import boss.boss_manifest.MajinBuu12H.Yacon;
import boss.boss_manifest.MajinBuu14H.Mabu2H;
import boss.boss_manifest.MajinBuu14H.SuperBu;
import boss.boss_manifest.GinyuForce.SO1;
import boss.boss_manifest.GinyuForce.SO2;
import boss.boss_manifest.GinyuForce.SO3;
import boss.boss_manifest.GinyuForce.SO4;
import boss.boss_manifest.GinyuForce.TDT;
import boss.boss_manifest.NamekGinyuForce.SO1_NM;
import boss.boss_manifest.NamekGinyuForce.SO2_NM;
import boss.boss_manifest.NamekGinyuForce.SO3_NM;
import boss.boss_manifest.NamekGinyuForce.SO4_NM;
import boss.boss_manifest.NamekGinyuForce.TDT_NM;
import boss.boss_manifest.Earth.BIDO;
import boss.boss_manifest.Earth.BOJACK;
import boss.boss_manifest.Earth.BUJIN;
import boss.boss_manifest.Earth.KOGU;
import boss.boss_manifest.Earth.SUPER_BOJACK;
import boss.boss_manifest.Earth.ZANGYA;
import boss.boss_manifest.Cell.XENCON1;
import boss.boss_manifest.Cell.XENCON2;
import boss.boss_manifest.Cell.XENCON3;
import boss.boss_manifest.Cell.XENCON4;
import boss.boss_manifest.Cell.XENCON5;
import boss.boss_manifest.Cell.XENCON6;
import boss.boss_manifest.Cell.XENCON7;
import boss.boss_manifest.Cumber.Cumber;
import boss.boss_manifest.Cumber.KALI3QUE;
import boss.boss_manifest.DaiChienThanThu.BachLang;
import boss.boss_manifest.DaiChienThanThu.HaiKhuyen;
import boss.boss_manifest.DaiChienThanThu.ThietMa;
import boss.boss_manifest.DaiChienThanThu.VuaBachThu;
import boss.boss_manifest.LunarNewYearEvent.LanCon;
import boss.boss_manifest.Nhan_Gioi.CONCAK;
import player.Player;
import network.Message;

import java.util.ArrayList;
import java.util.List;

import map.Zone;
import server.Maintenance;
import utils.Logger;
import utils.Util;

public class BossManager implements Runnable {

    private static BossManager instance;
    public static byte ratioReward = 10;

    public static BossManager gI() {
        if (instance == null) {
            instance = new BossManager();
        }
        return instance;
    }

    public BossManager() {
        this.bosses = new ArrayList<>();
    }

    protected final List<Boss> bosses;

    public void addBoss(Boss boss) {
        this.bosses.add(boss);
    }

    public void removeBoss(Boss boss) {
        this.bosses.remove(boss);
    }

    public void loadBoss() {
        this.createBoss(BossID.TIEU_DOI_TRUONG);
        this.createBoss(BossID.TIEU_DOI_TRUONG_NM);
        this.createBoss(BossID.BOJACK);
        this.createBoss(BossID.SUPER_BOJACK);
        this.createBoss(BossID.KING_KONG);
        this.createBoss(BossID.XEN_BO_HUNG);
        this.createBoss(BossID.SIEU_BO_HUNG);
        this.createBoss(BossID.KUKU);
        this.createBoss(BossID.MAP_DAU_DINH);
        this.createBoss(BossID.RAMBO);
        this.createBoss(BossID.FIDE);
        this.createBoss(BossID.ANDROID_14);
        this.createBoss(BossID.DR_KORE);
        this.createBoss(BossID.COOLER);
        this.createBoss(BossID.BLACK_GOKU);
        this.createBoss(BossID.GOLDEN_FRIEZA);
        this.createBoss(BossID.BLACK_GOKU);
        this.createBoss(BossID.BROLY);
        this.createBoss(BossID.CUMBER);
        this.createBoss(BossID.NGUSAC);
        this.createBoss(BossID.ZAMASU);
        this.createBoss(BossID.KELA);
        this.createBoss(BossID.OBITOVIP);
        this.createBoss(BossID.FU);
        this.createBoss(BossID.XETANG390);
        this.createBoss(BossID.BLACKGOKU);
        this.createBoss(BossID.BLACKGOKUROSE);
        this.createBoss(BossID.doremon);
        this.createBoss(BossID.nobita);
        this.createBoss(BossID.xuka);
        this.createBoss(BossID.xeko);
        this.createBoss(BossID.chanen);
        this.createBoss(BossID.pan, 2);
        this.createBoss(BossID.vithu1);
        this.createBoss(BossID.vithu2);
        this.createBoss(BossID.vithu3);
        this.createBoss(BossID.vithu4);
        this.createBoss(BossID.vithu5);
        this.createBoss(BossID.vithu6);
        this.createBoss(BossID.vithu7);
        this.createBoss(BossID.vithu8);
        this.createBoss(BossID.vithu9);
         this.createBoss(BossID.BOSSNGOCRONG,5);
        this.createBoss(BossID.cogiaothao);
        this.createBoss(BossID.NYCTHAO);
        this.createBoss(BossID.KALI3QUE);
         this.createBoss(BossID.NYCLOAN);
         this.createBoss(BossID.CONCAK);
         this.createBoss(BossID.bosskeyvang);
       this.createBoss(BossID.LUFFI);
       this.createBoss(BossID.SANJI);
       this.createBoss(BossID.BOSSADMIN);
        this.createBoss(BossID.broly1);
         this.createBoss(BossID.OBITO_LUC_DAO1);
         this.createBoss(BossID.vlxx);
            this.createBoss(BossID.sex);
       
    }

    public void createBoss(int bossID, int total) {
        for (int i = 0; i < total; i++) {
            createBoss(bossID);
        }
    }

    public Boss createBossBroly(int bossID, double hp) {
        try {
            switch (bossID) {
                case BossID.BROLY:
                    return new Broly(hp);
                case BossID.SUPER_BROLY:
                    return new SuperBrolyNew();
                default:
                    return null;
            }
        } catch (Exception e) {
            Logger.error(e + "\n");
            return null;
        }
    }
    public Boss boss(int bossID, double hp) {
        try {
            switch (bossID) {
                case BossID.broly1:
                    return new Broly(hp);
                case BossID.SUPER_BROLY:
                    return new SuperBrolyNew();
                default:
                    return null;
            }
        } catch (Exception e) {
            Logger.error(e + "\n");
            return null;
        }
    }

    public Boss createBoss(int bossID) {
        try {
            return switch (bossID) {
                case BossID.HAI_KHUYEN ->
                    new HaiKhuyen();
                    case BossID.KALI3QUE ->
                    new KALI3QUE();
                         case BossID.CONCAK ->
                    new CONCAK();
                      case BossID.NYCLOAN ->
                    new NYCLOAN();
                     case BossID.cogiaothao ->
                    new GokuBlack();
                case BossID.BACH_LANG ->
                    new BachLang();
                case BossID.THIET_MA ->
                    new ThietMa();
                   case BossID.NYCTHAO ->
                    new NYCTHAO();
                case BossID.VUA_BACH_THU ->
                    new VuaBachThu();
                case BossID.OBITO_LUC_DAO ->
                    new ObitoLucDao();
                case BossID.CUU_VI ->
                    new CuuVi();
                case BossID.OBITO ->
                    new Obito();
                  case BossID.bosskeyvang ->
                    new bosskeyvang(); 
                    case BossID.LUFFI ->
                    new LUFFI();    
                        case BossID.SANJI ->
                    new SANJI();   
                            case BossID.BOSSADMIN ->
                    new BOSSADMIN();
                                case BossID.OBITO_LUC_DAO1 ->
                    new ObitoLucDao();
//                case BossID.TAP_SU_0 -> new TAPSU0();
//                case BossID.TAP_SU_1 -> new TAPSU1();
//                case BossID.TAP_SU_2 -> new TAPSU2();
//                case BossID.TAP_SU_3 -> new TAPSU3();
//                case BossID.TAP_SU_4 -> new TAPSU4();
//                case BossID.TAN_BINH_5 -> new TANBINH5();
//                case BossID.TAN_BINH_0 -> new TANBINH0();
//                case BossID.TAN_BINH_1 -> new TANBINH1();
//                case BossID.TAN_BINH_2 -> new TANBINH2();
//                case BossID.TAN_BINH_3 -> new TANBINH3();
//                case BossID.TAN_BINH_4 -> new TANBINH4();
//                case BossID.CHIEN_BINH_5 -> new CHIENBINH5();
//                case BossID.CHIEN_BINH_0 -> new CHIENBINH0();
//                case BossID.CHIEN_BINH_1 -> new CHIENBINH1();
//                case BossID.CHIEN_BINH_2 -> new CHIENBINH2();
//                case BossID.CHIEN_BINH_3 -> new CHIENBINH3();
//                case BossID.CHIEN_BINH_4 -> new CHIENBINH4();
//                case BossID.DOI_TRUONG_5 -> new DOITRUONG5();
                case BossID.SO_4 ->
                    new SO4();
                case BossID.SO_3 ->
                    new SO3();
                case BossID.SO_2 ->
                    new SO2();
                case BossID.SO_1 ->
                    new SO1();
                case BossID.TIEU_DOI_TRUONG ->
                    new TDT();
                case BossID.SO_4_NM ->
                    new SO4_NM();
                case BossID.SO_3_NM ->
                    new SO3_NM();
                case BossID.SO_2_NM ->
                    new SO2_NM();
                case BossID.SO_1_NM ->
                    new SO1_NM();
                case BossID.TIEU_DOI_TRUONG_NM ->
                    new TDT_NM();
                case BossID.BUJIN ->
                    new BUJIN();
                case BossID.KOGU ->
                    new KOGU();
                case BossID.ZANGYA ->
                    new ZANGYA();
                case BossID.BIDO ->
                    new BIDO();
                case BossID.BOJACK ->
                    new BOJACK();
                case BossID.SUPER_BOJACK ->
                    new SUPER_BOJACK();
                case BossID.KUKU ->
                    new Kuku();
                case BossID.MAP_DAU_DINH ->
                    new MapDauDinh();
                case BossID.RAMBO ->
                    new Rambo();
                case BossID.TAU_PAY_PAY_DONG_NAM_KARIN ->
                    new TaoPaiPai();
                case BossID.DRABURA ->
                    new Drabura();
                case BossID.BUI_BUI ->
                    new BuiBui();
                case BossID.BUI_BUI_2 ->
                    new BuiBui2();
                case BossID.YA_CON ->
                    new Yacon();
                case BossID.DRABURA_2 ->
                    new Drabura2();
                case BossID.GOKU ->
                    new Goku();
                case BossID.CADIC ->
                    new Cadic();
                case BossID.MABU_12H ->
                    new Mabu();
                case BossID.DRABURA_3 ->
                    new Drabura3();
                case BossID.MABU ->
                    new Mabu2H();
                case BossID.SUPERBU ->
                    new SuperBu();
                case BossID.FIDE ->
                    new Fide();
                case BossID.DR_KORE ->
                    new DrKore();
                case BossID.ANDROID_19 ->
                    new Android19();
                case BossID.ANDROID_13 ->
                    new Android13();
                case BossID.ANDROID_14 ->
                    new Android14();
                case BossID.ANDROID_15 ->
                    new Android15();
                case BossID.PIC ->
                    new Pic();
                case BossID.POC ->
                    new Poc();
                case BossID.KING_KONG ->
                    new KingKong();
                case BossID.XEN_BO_HUNG ->
                    new XenBoHung();
                case BossID.SIEU_BO_HUNG ->
                    new SieuBoHung();
                case BossID.XEN_CON_1 ->
                    new XENCON1();
                case BossID.XEN_CON_2 ->
                    new XENCON2();
                case BossID.XEN_CON_3 ->
                    new XENCON3();
                case BossID.XEN_CON_4 ->
                    new XENCON4();
                case BossID.XEN_CON_5 ->
                    new XENCON5();
                case BossID.XEN_CON_6 ->
                    new XENCON6();
                case BossID.XEN_CON_7 ->
                    new XENCON7();
                case BossID.COOLER ->
                    new Cooler();
                case BossID.BROLY ->
                    new Broly();
                case BossID.KHIDOT ->
                    new KhiDot();
                case BossID.NGUYETTHAN ->
                    new NguyetThan();
                case BossID.NHATTHAN ->
                    new NhatThan();
                case BossID.GOLDEN_FRIEZA ->
                    new GoldenFrieza();
                case BossID.DEATH_BEAM_1 ->
                    new DeathBeam1();
                case BossID.DEATH_BEAM_2 ->
                    new DeathBeam2();
                case BossID.DEATH_BEAM_3 ->
                    new DeathBeam3();
                case BossID.DEATH_BEAM_4 ->
                    new DeathBeam4();
                case BossID.DEATH_BEAM_5 ->
                    new DeathBeam5();
                case BossID.BIMA ->
                    new BiMa();
                case BossID.MATROI ->
                    new MaTroi();
                case BossID.DOI ->
                    new Doi();
                case BossID.ONG_GIA_NOEL ->
                    new OngGiaNoel();
                case BossID.SON_TINH ->
                    new SonTinh();
                case BossID.THUY_TINH ->
                    new ThuyTinh();
                case BossID.LAN_CON ->
                    new LanCon();
                case BossID.BLACK_GOKU ->
                    new BlackGoku();
                case BossID.SUPER_BROLY ->
                    new SuperBrolyNew();
                case BossID.CUMBER ->
                    new Cumber();
                case BossID.NGUSAC ->
                    new NGUSAC();
                case BossID.ZAMASU ->
                    new ZAMASU();
                case BossID.KELA ->
                    new KELA();
                case BossID.OBITOVIP ->
                    new OBITOVIP();
                case BossID.FU ->
                    new FU();
                case BossID.XETANG390 ->
                    new XETANG390();
                case BossID.BLACKGOKU ->
                    new BLACKGOKU();
                case BossID.BLACKGOKUROSE ->
                    new BLACKGOKUROSE();
                case BossID.doremon ->
                    new doremon();
                case BossID.nobita ->
                    new nobita();
                case BossID.xuka ->
                    new xuka();
                case BossID.xeko ->
                    new xeko();
                case BossID.chanen ->
                    new chanen();
                case BossID.pan ->
                    new pan();
                case BossID.vithu1 ->
                    new vithu1();

                  case BossID.vithu2 ->
                    new vithu2();   
                   case BossID.vithu3 ->
                    new vithu3();  
                     case BossID.vithu4 ->
                    new vithu4();
                     case BossID.vithu5 ->
                    new vithu5();
                     case BossID.vithu6 ->
                    new vithu6();
                     case BossID.vithu7 ->
                    new vithu7();
                     case BossID.vithu8 ->
                    new vithu8();
                     case BossID.vithu9 ->
                    new vithu9();
                     case BossID.BOSSNGOCRONG ->
                    new BOSSNGOCRONG();
                    
                    
                    
                default ->
                    null;
            };
        } catch (Exception e) {
            Logger.error(e + "\n");
            return null;
        }
    }

    public Boss getBoss(int id) {
        try {
            Boss boss = this.bosses.get(id);
            if (boss != null) {
                return boss;
            }
        } catch (Exception e) {
        }
        return null;
    }

    public void showListBoss(Player player) {
        player.iDMark.setMenuType(3);
        Message msg;
        try {
            msg = new Message(-96);
            msg.writer().writeByte(0);

            // Tổng số boss
            msg.writer().writeUTF("Tổng Boss: " + bosses.size());
            msg.writer().writeInt(bosses.size());

            for (int i = 0; i < bosses.size(); i++) {
                Boss boss = this.bosses.get(i);

                // ID hiển thị (nếu cần)
                msg.writer().writeInt(i);
                msg.writer().writeInt(i);

                // Ngoại hình
                msg.writer().writeShort(boss.data[0].getOutfit()[0]); // đầu
                if (player.getSession().version >= 214) {
                    msg.writer().writeShort(-1); // aura (nếu cần)
                }
                msg.writer().writeShort(boss.data[0].getOutfit()[1]); // áo
                msg.writer().writeShort(boss.data[0].getOutfit()[2]); // quần

                // Tên boss
                msg.writer().writeUTF(boss.data[0].getName());

                // Trạng thái boss
                if (boss.zone != null && boss.zone.map != null) {
                    msg.writer().writeUTF("on");
                    msg.writer().writeUTF("Thông Tin Boss\n"
                            + "|4|Bản Đồ : [" + boss.zone.map.mapName + "][" + boss.zone.map.mapId + "] \n"
//                            + "Khu Vực: [" + boss.zone.zoneId + "]\n"
                            + "HP: " + Util.numberToMoney(boss.nPoint.hp) + "\n"
                            + "Dame: " + Util.numberToMoney(boss.nPoint.dame) + "\n"
                            + "Chí Mạng: " + Util.numberToMoney(boss.nPoint.crit));
                } else {
                    msg.writer().writeUTF("off");
                    msg.writer().writeUTF("Thông Tin Boss\n"
                            + "|7|Time Reset: " + (boss.secondsRest == 0 ? "Chưa Xác Định" : Util.tinhgiay(boss.secondsRest)));
                }
            }

            player.sendMessage(msg);
            msg.cleanup();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public Boss getBossById(int bossId) {
        return this.bosses.stream().filter(boss -> boss.id == bossId && !boss.isDie()).findFirst().orElse(null);
    }

    public boolean checkBosses(Zone zone, int BossID) {
        return this.bosses.stream()
                .filter(boss -> boss.id == BossID && boss.zone != null && boss.zone.equals(zone) && !boss.isDie())
                .findFirst().orElse(null) != null;
    }

    public Player findBossClone(Player player) {
        return player.zone.getBosses().stream().filter(boss -> boss.id < -100_000_000 && !boss.isDie()).findFirst()
                .orElse(null);
    }

    public Boss getBossById(int bossId, int mapId, int zoneId) {
        return this.bosses.stream().filter(boss -> boss.id == bossId && boss.zone != null
                && boss.zone.map.mapId == mapId && boss.zone.zoneId == zoneId && !boss.isDie()).findFirst()
                .orElse(null);
    }

    @Override
    public void run() {
        while (!Maintenance.isRunning) {
            try {
                int delay = 500;
                long st = System.currentTimeMillis();
                for (int i = this.bosses.size() - 1; i >= 0; i--) {
                    try {
                        this.bosses.get(i).update();
                    } catch (Exception e) {
                        e.printStackTrace();
                    }
                }
                if (delay - (System.currentTimeMillis() - st) > 0) {
                    Thread.sleep(delay - (System.currentTimeMillis() - st));
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
    }

}
